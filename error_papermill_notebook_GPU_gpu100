ERROR: Unable to locate a modulefile for 'tensorflow/2.3.1gpu'
ERROR: Unable to locate a modulefile for 'tensorflow/2.3.1gpu'
Input Notebook:  009-train-CVAE-cmats.ipynb
Input Notebook:  009-train-CVAE-cmats.ipynb
Output Notebook: /data/aglinska/BC-fMRI-AE/Assets/tf_weights/Sep2-DIM_16_16-beta-1e-6-gamma-1-filt64-v5/CVAE_train_2022-09-05-19-15-18.ipynb
Output Notebook: /data/aglinska/BC-fMRI-AE/Assets/tf_weights/Sep2-DIM_16_16-beta-1e-6-gamma-1-filt64-v4/CVAE_train_2022-09-05-19-15-18.ipynb
Generating grammar tables from /data/aglinska/anaconda3/lib/python3.8/site-packages/blib2to3/Grammar.txt
Generating grammar tables from /data/aglinska/anaconda3/lib/python3.8/site-packages/blib2to3/Grammar.txt
Writing grammar tables to /data/aglinska/.cache/black/21.8b0/Grammar3.8.5.final.0.pickle
Writing grammar tables to /data/aglinska/.cache/black/21.8b0/Grammar3.8.5.final.0.pickle
Writing failed: [Errno 2] No such file or directory: '/data/aglinska/.cache/black/21.8b0/tmpn59zv1t1'
Writing failed: [Errno 2] No such file or directory: '/data/aglinska/.cache/black/21.8b0/tmp3qz0g0ol'
Generating grammar tables from /data/aglinska/anaconda3/lib/python3.8/site-packages/blib2to3/PatternGrammar.txt
Generating grammar tables from /data/aglinska/anaconda3/lib/python3.8/site-packages/blib2to3/PatternGrammar.txt
Writing grammar tables to /data/aglinska/.cache/black/21.8b0/PatternGrammar3.8.5.final.0.pickle
Writing grammar tables to /data/aglinska/.cache/black/21.8b0/PatternGrammar3.8.5.final.0.pickle
Writing failed: [Errno 2] No such file or directory: '/data/aglinska/.cache/black/21.8b0/tmpm156vq_5'
Writing failed: [Errno 2] No such file or directory: '/data/aglinska/.cache/black/21.8b0/tmpgbzea0r2'
Executing:   0%|          | 0/63 [00:00<?, ?cell/s]Executing:   0%|          | 0/63 [00:00<?, ?cell/s]Executing notebook with kernel: python3
Executing notebook with kernel: python3
Executing:   2%|▏         | 1/63 [00:05<05:11,  5.03s/cell]Executing:   2%|▏         | 1/63 [00:05<05:11,  5.03s/cell]Executing:   3%|▎         | 2/63 [00:05<03:37,  3.57s/cell]Executing:   3%|▎         | 2/63 [00:05<03:37,  3.57s/cell]Executing:   6%|▋         | 4/63 [00:05<02:28,  2.52s/cell]Executing:   6%|▋         | 4/63 [00:05<02:28,  2.52s/cell]2022-09-05 19:15:38.270895: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:15:38.270948: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:04.072519: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-05 19:16:04.072518: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-09-05 19:16:04.082046: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2400000000 Hz
2022-09-05 19:16:04.085321: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55555a96b1c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-09-05 19:16:04.085346: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-09-05 19:16:04.091978: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2022-09-05 19:16:04.093958: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2400000000 Hz
2022-09-05 19:16:04.097304: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55555a96a220 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-09-05 19:16:04.097334: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-09-05 19:16:04.099477: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2022-09-05 19:16:04.297811: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55555a9e3b20 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-09-05 19:16:04.297893: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-09-05 19:16:04.298996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2022-09-05 19:16:04.299047: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:04.301743: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55555a9e2b90 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-09-05 19:16:04.301810: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla V100-SXM2-16GB, Compute Capability 7.0
2022-09-05 19:16:04.302835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2022-09-05 19:16:04.302893: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:04.308564: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2022-09-05 19:16:04.309663: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2022-09-05 19:16:04.311442: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2022-09-05 19:16:04.311582: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2022-09-05 19:16:04.312754: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2022-09-05 19:16:04.312859: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2022-09-05 19:16:04.317384: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2022-09-05 19:16:04.317416: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2022-09-05 19:16:04.318463: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2022-09-05 19:16:04.318768: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2022-09-05 19:16:04.322100: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2022-09-05 19:16:04.322221: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2022-09-05 19:16:04.325402: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2022-09-05 19:16:04.325449: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:04.325491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2022-09-05 19:16:04.325532: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:05.721747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-09-05 19:16:05.721819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2022-09-05 19:16:05.721828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2022-09-05 19:16:05.723738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14360 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0)
Executing:   8%|▊         | 5/63 [00:35<10:24, 10.77s/cell]2022-09-05 19:16:05.780383: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-09-05 19:16:05.780422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2022-09-05 19:16:05.780431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2022-09-05 19:16:05.782206: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14341 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0)
Executing:   8%|▊         | 5/63 [00:35<10:25, 10.79s/cell]Executing:  10%|▉         | 6/63 [00:35<07:13,  7.60s/cell]Executing:  10%|▉         | 6/63 [00:35<07:13,  7.61s/cell]Executing:  11%|█         | 7/63 [00:35<04:59,  5.36s/cell]2022-09-05 19:16:06.117541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2022-09-05 19:16:06.117603: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:06.117629: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2022-09-05 19:16:06.117639: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2022-09-05 19:16:06.117649: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2022-09-05 19:16:06.117659: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2022-09-05 19:16:06.117669: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2022-09-05 19:16:06.117679: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2022-09-05 19:16:06.119300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2022-09-05 19:16:06.119361: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:06.119394: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2022-09-05 19:16:06.119405: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2022-09-05 19:16:06.119416: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2022-09-05 19:16:06.119427: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2022-09-05 19:16:06.119437: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2022-09-05 19:16:06.119448: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2022-09-05 19:16:06.120952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2022-09-05 19:16:06.120991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-09-05 19:16:06.120999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2022-09-05 19:16:06.121006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2022-09-05 19:16:06.122825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2022-09-05 19:16:06.122863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-09-05 19:16:06.122879: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2022-09-05 19:16:06.122885: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2022-09-05 19:16:06.124445: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14360 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0)
2022-09-05 19:16:06.125485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/device:GPU:0 with 14341 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0)
2022-09-05 19:16:06.126209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2022-09-05 19:16:06.126245: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:06.126266: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2022-09-05 19:16:06.126277: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2022-09-05 19:16:06.126286: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2022-09-05 19:16:06.126295: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2022-09-05 19:16:06.126305: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2022-09-05 19:16:06.126314: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2022-09-05 19:16:06.128025: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2022-09-05 19:16:06.128062: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:06.128080: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2022-09-05 19:16:06.128090: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2022-09-05 19:16:06.128099: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2022-09-05 19:16:06.128108: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2022-09-05 19:16:06.128117: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2022-09-05 19:16:06.128127: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2022-09-05 19:16:06.129647: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2022-09-05 19:16:06.130726: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2022-09-05 19:16:06.131601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2022-09-05 19:16:06.131634: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:06.131651: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2022-09-05 19:16:06.131661: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2022-09-05 19:16:06.131670: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2022-09-05 19:16:06.131680: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2022-09-05 19:16:06.131689: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2022-09-05 19:16:06.131698: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2022-09-05 19:16:06.132481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:18:00.0 name: Tesla V100-SXM2-16GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 15.78GiB deviceMemoryBandwidth: 836.37GiB/s
2022-09-05 19:16:06.132518: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
2022-09-05 19:16:06.132537: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.10
2022-09-05 19:16:06.132548: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2022-09-05 19:16:06.132559: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2022-09-05 19:16:06.132570: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2022-09-05 19:16:06.132580: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.10
2022-09-05 19:16:06.132591: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2022-09-05 19:16:06.135039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2022-09-05 19:16:06.135065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-09-05 19:16:06.135072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2022-09-05 19:16:06.135078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2022-09-05 19:16:06.135867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2022-09-05 19:16:06.135894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-09-05 19:16:06.135901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2022-09-05 19:16:06.135907: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2022-09-05 19:16:06.138256: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14360 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0)
2022-09-05 19:16:06.138919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 14341 MB memory) -> physical GPU (device: 0, name: Tesla V100-SXM2-16GB, pci bus id: 0000:18:00.0, compute capability: 7.0)
2022-09-05 19:16:06.471941: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 14.00G (15038236416 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.472869: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 12.60G (13534412800 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.473575: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 11.34G (12180971520 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.474259: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 10.21G (10962874368 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.474938: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 9.19G (9866587136 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.475613: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 8.27G (8879928320 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.476295: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 7.44G (7991935488 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.476971: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 6.70G (7192741888 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.477646: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 6.03G (6473467392 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.478323: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 5.43G (5826120704 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.478997: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 4.88G (5243508736 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.479671: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 4.39G (4719157760 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.480350: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 3.96G (4247241984 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.481037: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 3.56G (3822517760 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.481709: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 3.20G (3440265984 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.482384: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 2.88G (3096239360 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.483067: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 2.59G (2786615296 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.483738: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 2.33G (2507953664 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.484412: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 2.10G (2257158144 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.485111: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 1.89G (2031442432 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.485803: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 1.70G (1828298240 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.486491: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 1.53G (1645468416 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.487186: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 1.38G (1480921600 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.487860: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 1.24G (1332829440 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.488534: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 1.12G (1199546624 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.489234: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 1.00G (1079591936 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.489922: I tensorflow/stream_executor/cuda/cuda_driver.cc:775] failed to allocate 926.62M (971632896 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
2022-09-05 19:16:06.570374: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2022-09-05 19:16:06.608005: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.7
2022-09-05 19:16:06.652969: E tensorflow/stream_executor/cuda/cuda_dnn.cc:328] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR
2022-09-05 19:16:06.658842: E tensorflow/stream_executor/cuda/cuda_dnn.cc:328] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR
2022-09-05 19:16:06.666399: E tensorflow/stream_executor/cuda/cuda_dnn.cc:328] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR
2022-09-05 19:16:06.667985: E tensorflow/stream_executor/cuda/cuda_dnn.cc:328] Could not create cudnn handle: CUDNN_STATUS_INTERNAL_ERROR
Executing:  13%|█▎        | 8/63 [00:38<04:19,  4.73s/cell]Executing:  13%|█▎        | 8/63 [00:38<05:20,  5.83s/cell]Executing:  13%|█▎        | 8/63 [00:39<04:31,  4.94s/cell]
Executing:  13%|█▎        | 8/63 [00:39<04:32,  4.95s/cell]Traceback (most recent call last):
  File "/data/aglinska/anaconda3/bin/papermill", line 8, in <module>
    sys.exit(papermill())
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/click/decorators.py", line 21, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/papermill/cli.py", line 250, in papermill
    execute_notebook(
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/papermill/execute.py", line 122, in execute_notebook
    raise_for_execution_errors(nb, output_path)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/papermill/execute.py", line 234, in raise_for_execution_errors
    raise error
papermill.exceptions.PapermillExecutionError: 
---------------------------------------------------------------------------
Exception encountered at "In [7]":
---------------------------------------------------------------------------
UnknownError                              Traceback (most recent call last)
<ipython-input-7-5807fd4c123c> in <module>
     25 # We run each op once to warm up; see: https://stackoverflow.com/a/45067900
     26 cpu()
---> 27 gpu()
     28 
     29 # Run the op several times.

<ipython-input-7-5807fd4c123c> in gpu()
     20     with tf.device('/device:GPU:0'):
     21         random_image_gpu = tf.random.normal((100, 100, 100, 3))
---> 22         net_gpu = tf.keras.layers.Conv2D(32, 7)(random_image_gpu)
     23     return tf.math.reduce_sum(net_gpu)
     24 

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py in __call__(self, *args, **kwargs)
    983 
    984         with ops.enable_auto_cast_variables(self._compute_dtype_object):
--> 985           outputs = call_fn(inputs, *args, **kwargs)
    986 
    987         if self._activity_regularizer:

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/keras/layers/convolutional.py in call(self, inputs)
    245       inputs = array_ops.pad(inputs, self._compute_causal_padding(inputs))
    246 
--> 247     outputs = self._convolution_op(inputs, self.kernel)
    248 
    249     if self.use_bias:

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py in wrapper(*args, **kwargs)
    199     """Call target, and fall back on dispatchers if there is a TypeError."""
    200     try:
--> 201       return target(*args, **kwargs)
    202     except (TypeError, ValueError):
    203       # Note: convert_to_eager_tensor currently raises a ValueError, not a

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/nn_ops.py in convolution_v2(input, filters, strides, padding, data_format, dilations, name)
   1008     dilations=None,
   1009     name=None):
-> 1010   return convolution_internal(
   1011       input,  # pylint: disable=redefined-builtin
   1012       filters,

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/nn_ops.py in convolution_internal(input, filters, strides, padding, data_format, dilations, name, call_from_convolution, num_spatial_dims)
   1138         op = conv1d
   1139 
-> 1140       return op(
   1141           input,
   1142           filters,

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/nn_ops.py in _conv2d_expanded_batch(input, filters, strides, padding, data_format, dilations, name)
   2582     # We avoid calling squeeze_batch_dims to reduce extra python function
   2583     # call slowdown in eager mode.  This branch doesn't require reshapes.
-> 2584     return gen_nn_ops.conv2d(
   2585         input,
   2586         filter=filters,

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/gen_nn_ops.py in conv2d(input, filter, strides, padding, use_cudnn_on_gpu, explicit_paddings, data_format, dilations, name)
    936       return _result
    937     except _core._NotOkStatusException as e:
--> 938       _ops.raise_from_not_ok_status(e, name)
    939     except _core._FallbackException:
    940       pass

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/framework/ops.py in raise_from_not_ok_status(e, name)
   6841   message = e.message + (" name: " + name if name is not None else "")
   6842   # pylint: disable=protected-access
-> 6843   six.raise_from(core._status_to_exception(e.code, message), None)
   6844   # pylint: enable=protected-access
   6845 

~/anaconda3/lib/python3.8/site-packages/six.py in raise_from(value, from_value)

UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above. [Op:Conv2D]


Traceback (most recent call last):
  File "/data/aglinska/anaconda3/bin/papermill", line 8, in <module>
    sys.exit(papermill())
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/click/decorators.py", line 21, in new_func
    return f(get_current_context(), *args, **kwargs)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/papermill/cli.py", line 250, in papermill
    execute_notebook(
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/papermill/execute.py", line 122, in execute_notebook
    raise_for_execution_errors(nb, output_path)
  File "/data/aglinska/anaconda3/lib/python3.8/site-packages/papermill/execute.py", line 234, in raise_for_execution_errors
    raise error
papermill.exceptions.PapermillExecutionError: 
---------------------------------------------------------------------------
Exception encountered at "In [7]":
---------------------------------------------------------------------------
UnknownError                              Traceback (most recent call last)
<ipython-input-7-5807fd4c123c> in <module>
     25 # We run each op once to warm up; see: https://stackoverflow.com/a/45067900
     26 cpu()
---> 27 gpu()
     28 
     29 # Run the op several times.

<ipython-input-7-5807fd4c123c> in gpu()
     20     with tf.device('/device:GPU:0'):
     21         random_image_gpu = tf.random.normal((100, 100, 100, 3))
---> 22         net_gpu = tf.keras.layers.Conv2D(32, 7)(random_image_gpu)
     23     return tf.math.reduce_sum(net_gpu)
     24 

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py in __call__(self, *args, **kwargs)
    983 
    984         with ops.enable_auto_cast_variables(self._compute_dtype_object):
--> 985           outputs = call_fn(inputs, *args, **kwargs)
    986 
    987         if self._activity_regularizer:

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/keras/layers/convolutional.py in call(self, inputs)
    245       inputs = array_ops.pad(inputs, self._compute_causal_padding(inputs))
    246 
--> 247     outputs = self._convolution_op(inputs, self.kernel)
    248 
    249     if self.use_bias:

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py in wrapper(*args, **kwargs)
    199     """Call target, and fall back on dispatchers if there is a TypeError."""
    200     try:
--> 201       return target(*args, **kwargs)
    202     except (TypeError, ValueError):
    203       # Note: convert_to_eager_tensor currently raises a ValueError, not a

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/nn_ops.py in convolution_v2(input, filters, strides, padding, data_format, dilations, name)
   1008     dilations=None,
   1009     name=None):
-> 1010   return convolution_internal(
   1011       input,  # pylint: disable=redefined-builtin
   1012       filters,

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/nn_ops.py in convolution_internal(input, filters, strides, padding, data_format, dilations, name, call_from_convolution, num_spatial_dims)
   1138         op = conv1d
   1139 
-> 1140       return op(
   1141           input,
   1142           filters,

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/nn_ops.py in _conv2d_expanded_batch(input, filters, strides, padding, data_format, dilations, name)
   2582     # We avoid calling squeeze_batch_dims to reduce extra python function
   2583     # call slowdown in eager mode.  This branch doesn't require reshapes.
-> 2584     return gen_nn_ops.conv2d(
   2585         input,
   2586         filter=filters,

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/gen_nn_ops.py in conv2d(input, filter, strides, padding, use_cudnn_on_gpu, explicit_paddings, data_format, dilations, name)
    936       return _result
    937     except _core._NotOkStatusException as e:
--> 938       _ops.raise_from_not_ok_status(e, name)
    939     except _core._FallbackException:
    940       pass

~/anaconda3/lib/python3.8/site-packages/tensorflow/python/framework/ops.py in raise_from_not_ok_status(e, name)
   6841   message = e.message + (" name: " + name if name is not None else "")
   6842   # pylint: disable=protected-access
-> 6843   six.raise_from(core._status_to_exception(e.code, message), None)
   6844   # pylint: enable=protected-access
   6845 

~/anaconda3/lib/python3.8/site-packages/six.py in raise_from(value, from_value)

UnknownError: Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above. [Op:Conv2D]

Executing:  60%|██████    | 38/63 [2:38:36<19:41:51, 2836.47s/cell]Executing:  63%|██████▎   | 40/63 [2:38:36<12:41:07, 1985.55s/cell]Executing:  67%|██████▋   | 42/63 [2:38:36<8:06:27, 1389.90s/cell] Executing:  70%|██████▉   | 44/63 [2:38:37<5:08:06, 972.95s/cell] Executing:  73%|███████▎  | 46/63 [2:38:37<3:12:58, 681.09s/cell]Executing:  75%|███████▍  | 47/63 [2:38:50<3:01:37, 681.09s/cell]Executing:  76%|███████▌  | 48/63 [2:39:00<2:00:03, 480.22s/cell]Executing:  78%|███████▊  | 49/63 [2:39:00<1:18:28, 336.30s/cell]Executing:  79%|███████▉  | 50/63 [2:39:00<51:00, 235.45s/cell]  Executing:  81%|████████  | 51/63 [2:39:01<32:58, 164.86s/cell]Executing:  83%|████████▎ | 52/63 [2:39:29<22:43, 123.96s/cell]Executing:  84%|████████▍ | 53/63 [2:39:30<14:30, 87.06s/cell] Executing:  86%|████████▌ | 54/63 [2:39:30<09:09, 61.00s/cell]Executing:  87%|████████▋ | 55/63 [2:41:26<10:18, 77.35s/cell]Executing:  89%|████████▉ | 56/63 [2:41:27<06:22, 54.61s/cell]Executing:  90%|█████████ | 57/63 [2:43:24<07:19, 73.24s/cell]Executing:  92%|█████████▏| 58/63 [2:43:24<04:16, 51.34s/cell]Executing:  94%|█████████▎| 59/63 [2:43:24<02:23, 36.00s/cell]Executing:  95%|█████████▌| 60/63 [2:43:25<01:15, 25.26s/cell]Executing:  97%|█████████▋| 61/63 [2:43:25<00:35, 17.74s/cell]Executing:  98%|█████████▊| 62/63 [2:43:25<00:12, 12.48s/cell]Executing: 100%|██████████| 63/63 [2:43:25<00:00,  8.79s/cell]Executing: 100%|██████████| 63/63 [2:43:29<00:00, 155.70s/cell]
